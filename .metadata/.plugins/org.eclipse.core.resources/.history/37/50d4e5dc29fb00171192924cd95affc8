package action;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import com.opensymphony.xwork2.ActionSupport;

import util.DBConnector;

public class ImageAction extends ActionSupport {
private String name;
private File image;

private DBConnector dbConnector = new DBConnector();

private Connection connection = dbConnector.getConnection();

public String sql= "INSERT INTO image_upload(NAME,IMAGE) VALUES(?,?)";


public String execute(){
	String result = null;
	//System.out.println("値チェック名前"+name);
	//System.out.println("値チェック画像"+image);


	try {
		PreparedStatement preparedStatement = connection.prepareStatement(sql);
		preparedStatement.setString(1, name);
		FileInputStream inputStream = new FileInputStream(image);
		preparedStatement.setBinaryStream(2, inputStream);
		preparedStatement.execute();


		result = SUCCESS;


	} catch (SQLException e) {
		e.printStackTrace();
		System.out.println("mysqlのエラー");
	} catch (FileNotFoundException e) {
		e.printStackTrace();
		e.printStackTrace();
		System.out.println("ファイルのエラー");
	}
	try {
		connection.close();
	} catch (Exception e) {

	}

	return result;

}

}
